# Схема базы данных Supabase

## Таблицы

### giveaways

| Поле | Тип | Описание |
|------|-----|----------|
| id | bigint | Уникальный идентификатор (первичный ключ) |
| channel | text | Имя Twitch канала |
| keyword | text | Ключевое слово для участия в розыгрыше |
| prize | text | Приз розыгрыша |
| started_at | timestamp with time zone | Время начала розыгрыша |
| ended_at | timestamp with time zone | Время завершения розыгрыша |
| is_active | boolean | Статус активности розыгрыша |
| winner | text | Победитель розыгрыша |

### participants

| Поле | Тип | Описание |
|------|-----|----------|
| id | bigint | Уникальный идентификатор (первичный ключ) |
| giveaway_id | bigint | Идентификатор розыгрыша (внешний ключ) |
| username | text | Имя пользователя Twitch |
| participated_at | timestamp with time zone | Время участия в розыгрыше |

## SQL скрипты для создания таблиц

```sql
-- Создание таблицы розыгрышей
CREATE TABLE giveaways (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  channel TEXT NOT NULL,
  keyword TEXT NOT NULL,
  prize TEXT NOT NULL,
  started_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  ended_at TIMESTAMP WITH TIME ZONE,
  is_active BOOLEAN DEFAULT true,
  winner TEXT
);

-- Создание таблицы участников
CREATE TABLE participants (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  giveaway_id BIGINT REFERENCES giveaways(id) ON DELETE CASCADE,
  username TEXT NOT NULL,
  participated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Создание индексов для оптимизации запросов
CREATE INDEX idx_giveaways_channel ON giveaways(channel);
CREATE INDEX idx_giveaways_active ON giveaways(is_active);
CREATE INDEX idx_participants_giveaway_id ON participants(giveaway_id);
CREATE INDEX idx_participants_username ON participants(username);
```

## Использование с Railway

После создания таблиц в Supabase, укажите URL и ключ в переменных окружения Railway:
- SUPABASE_URL - URL вашего проекта Supabase
- SUPABASE_KEY - анонимный ключ доступа к вашему проекту